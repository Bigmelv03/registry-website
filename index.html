<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Iglesia Buenas Nuevas ‚Äì Lista de Regalos por Fases</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
:root {
  --bg: #181818;
  --card: #23283a;
  --ink: #ffffff;
  --ink2: #aac;
  --ink3: #d6eaff;
  --cyan: #6ef;
  --link: #7cf;
  --price: #7fa;
  --accent: #ff9100;
  --note: #fc5;
  --shadow: 0 1px 8px #0004;
}

/* General layout */
body {
  background: var(--bg);
  color: var(--ink);
  font-family: 'Segoe UI', Arial, sans-serif;
  margin: 0;
  padding: 1em;
}
h1 { margin: 0 0 .6em 0; }
h2 { color: var(--cyan); margin-top: 1.7em; margin-bottom: 0.1em; }
.en { color: var(--ink2); font-size: 0.93em; margin: 0 0 0.7em 0; }

/* Message Card */
.message-card {
  display: none;
  background: var(--card);
  border-left: 6px solid var(--accent);
  box-shadow: var(--shadow);
  color: var(--ink3);
  padding: 1em 1.2em;
  border-radius: 10px;
  margin: 1.6em 0 2.2em 0;
  white-space: pre-line;
  text-align: center;
  font-size: 1.05em;
}
.message-card.active { display: block; }

/* Cards Grid */
.phase-items {
  display: flex;
  flex-wrap: wrap;
  gap: 1.2em;
  margin: 2.2em 0;
  justify-content: center;
  align-items: stretch;
}
.item {
  width: 215px;
  background: var(--card);
  border-radius: 12px;
  padding: 0.65em 0.5em 0.9em 0.5em;
  text-align: center;
  box-shadow: var(--shadow);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  position: relative;
}
.item img {
  max-width: 100%;
  max-height: 115px;
  margin-bottom: 0.6em;
  border-radius: 6px;
  background: #111;
  cursor: pointer;
  transition: transform 0.25s ease;
}
.item img:hover { transform: scale(1.03); }
.item-title {
  font-size: 1.07em;
  font-weight: 700;
  margin-bottom: 0.2em;
  min-height: 2.6em;
}
.price {
  font-size: 1.07em;
  color: var(--price);
  font-weight: 700;
  margin-bottom: 0.15em;
}
.qty { font-size: .96em; color: #fff9; margin-bottom: 0.3em; }
.desc {
  font-size: 0.97em;
  color: var(--ink3);
  margin-bottom: 0.33em;
  white-space: pre-line;
  flex: 1;
  display: flex;
  align-items: flex-end;
}

/* Badges */
.badge {
  position: absolute;
  top: -8px; left: -8px; right: -8px;
  background: #ff3b3b;
  color: white;
  font-weight: bold;
  font-size: 0.9em;
  border-radius: 8px 8px 0 0;
  padding: 0.4em 0.2em;
  box-shadow: 0 0 4px #0005;
  text-shadow: 0 0 2px #000a;
}
.badge.yellow { background: #ffd93b; color: #222; text-shadow: none; }
.badge.green {
  background: #00ff80;
  color: #003300;
  animation: neonflash 1s linear infinite alternate;
  box-shadow: 0 0 6px #00ff80;
}
@keyframes neonflash {
  0% { opacity: 1; box-shadow: 0 0 4px #00ff80, 0 0 10px #00ff80; }
  100% { opacity: 0.6; box-shadow: 0 0 6px #00ff80, 0 0 14px #00ff80; }
}

/* QR & Registry Section */
.registry-actions {
  width: 100%;
  clear: both;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.8em;
  margin: 2.2em 0;
}
.qr {
  text-align: center;
  margin: 0.9em 0;
}
.qr img {
  width: 128px;
  height: 128px;
  border-radius: 10px;
  border: 4px solid var(--accent);
  background: #fff;
  box-shadow: 0 1px 12px #0003;
}
.qr .cap {
  color: var(--accent);
  font-weight: 800;
  margin-top: .55em;
}
.qr .cap small {
  color: #aaa;
  font-weight: 600;
  display: block;
  margin-top: .15em;
}
.flash-reminder {
  font-weight: bold;
  color: #ffe53b;
  text-align: center;
  margin: 0.9em 0;
  animation: flash 0.6s linear infinite alternate;
  font-size: 1.08em;
  letter-spacing: .01em;
  text-shadow: 0 0 7px #fff6, 0 2px 0 #a43, 0 1px 8px #a43c;
  min-height: 3.5em;
  line-height: 1.2;
}
@keyframes flash {
  0% { opacity: 1; }
  65% { opacity: 1; }
  100% { opacity: 0.3; }
}
.button {
  margin: 1.2em 0;
  display: block;
  width: 99%;
  max-width: 420px;
  background: var(--accent);
  color: #fff;
  border: none;
  font-size: 1.12em;
  border-radius: 10px;
  padding: 0.9em 0.1em;
  text-align: center;
  font-weight: 800;
  cursor: pointer;
  text-decoration: none;
  box-shadow: 0 3px 14px #0006;
}

/* Info Cards */
.note {
  font-size: 1.01em;
  color: var(--note);
  margin: 1.2em 0 1.1em 0;
  text-align: center;
  background: #2a2822;
  border-radius: 10px;
  padding: 1em;
}
.top-card {
  background: var(--card);
  border-radius: 12px;
  padding: 1.1em 1.2em 1.3em 1.2em;
  box-shadow: var(--shadow);
}
.glory-flash {
  color: #ffe53b;
  font-weight: 900;
  animation: flash-excite 0.32s linear infinite alternate;
  text-align: center;
  font-size: 1.14em;
}
@keyframes flash-excite {
  0% { opacity: 1; }
  100% { opacity: 0.32; }
}
.phase-intro { margin-bottom:1.0em; white-space:pre-line; }
.small { font-size:.92em; color:#ddd; }

/* Modal */
.modal-img-bg {
  display: none;
  position: fixed; z-index: 1000;
  left: 0; top: 0; width: 100vw; height: 100vh;
  background: rgba(0,0,0,0.84);
  justify-content: center; align-items: center;
}
.modal-img-bg.active { display: flex; }
.modal-img-bg img {
  max-width: 94vw; max-height: 88vh;
  border-radius: 13px;
  box-shadow: 0 2px 22px #000a;
}
.modal-img-bg:after {
  content: "‚úï";
  position: absolute; top: 2.3em; right: 2.7em;
  color: #fff; font-size: 2.3em; font-weight: bold; cursor: pointer; z-index: 2000;
}

/* Responsive */
@media (max-width: 860px) {
  .phase-items { justify-content: center; }
  .item { width: 92vw; max-width: 350px; margin-left: auto; margin-right: auto; }
}
@media (max-width: 650px) {
  .modal-img-bg:after { top: 0.6em; right: 0.9em; font-size: 2em; }
}
@media (max-width: 520px) {
  .phase-items { gap: 1em; }
  .item { width: 98vw; max-width: 99vw; }
  .registry-actions { gap: 1em; margin: 1.2em 0 1.2em 0; }
}
</style>
</head>
<body>

  <h1>Iglesia Buenas Nuevas - Registro de sistemas de sonido</h1>
  <h2><span class="en" style="color:#aac;font-size:1.3em;">Good News Church - Sound System Registry</span></h2>

  <div id="messageCard" class="message-card"></div>

  <!-- =========================
     TESTIMONIO DE BENDICI√ìN / BLESSING TESTIMONY
     ========================= -->
<div class="top-card" style="margin:2.2em 0 2.2em 0; border-top:4px solid #ff9100;">
      <div class="glory-flash" style="margin-top:1.0em;">¬°Toda la gloria a √âl!</div>
  <br><br>
  Dios ya ha comenzado a bendecir este proyect
  El 23 de octubre de 2025, ¬°pudimos comprar la bater√≠a electr√≥nica con un descuento especial de $144 durante una oferta rel√°mpago de solo dos horas!<br>
  Es una confirmaci√≥n de que el Se√±or est√° abriendo puertas y proveyendo exactamente lo que necesitamos, en el momento perfecto.<br>
  Seguimos adelante con fe, confiando en que cada fase ser√° respaldada por Su provisi√≥n y gracia.<br><br>
      <div class="glory-flash" style="margin-top:1.0em;">To God be the glory!</div><br><br>
      
    God is already starting to bless us in this project, and we want to share it with everyone.<br>
    On 10-23-2025, we were able to purchase the electronic drum set at a special $144 discount during a two-hour lightning deal!<br>
    It‚Äôs proof that the Lord is opening doors and providing exactly what we need at just the right time.<br>
    We continue moving forward in faith, trusting that every phase will be covered by His provision and grace.

</div>

  <!-- INTRO STORY -->
<div class="top-card" style="margin:2.2em 0 2.2em 0; border-top:4px solid #ff9100;">
      <h2 style="color:#ff9100; margin-top:1em;">
  El Coraz√≥n Detr√°s del Proyecto / The Heart Behind the Project
</h2><br><br>

  <b>¬°Hola familia! Gracias por apoyar el ministerio de sonido. üôåüèΩ</b>
  <br><br>
  Nuestra congregaci√≥n Buenas Nuevas ya comenz√≥ y nos reunimos cada semana. Por ahora, nos ‚Äúdefendemos‚Äù con bocinas personales y micr√≥fonos b√°sicos, lo que hace que las voces se pierdan entre la m√∫sica y todo quede un poco fuera de balance; a veces ni siquiera se entiende bien a la Pastora. Nos alcanza por ahora, pero seamos honestos: no podemos quedarnos as√≠. Dios no solo nos llama a conformarnos‚Äî√âl nos llama a *cultivar* y mejorar lo que nos ha dado, como Ad√°n en el jard√≠n. Dios nos da el espacio, pero es nuestro trabajo cultivarlo y convertirlo en iglesia, justamente lo que hemos estado orando. Cada paso que damos es nuestra manera de honrar al Se√±or y usar bien el dinero y los recursos que √âl nos ha confiado (‚Äúel se√±or les dio a sus siervos talentos, cada uno seg√∫n su capacidad‚Äù; somos llamados a multiplicar lo que √âl nos da ‚Äì Mat. 25:14-30).<br><br>
  <b>Como familia en Cristo, avanzamos en unidad, poniendo el coraz√≥n en todo lo que hacemos (Col. 3:23). Cada regalo‚Äîgrande o peque√±o‚Äîes una inversi√≥n directa en el futuro de Buenas Nuevas y en el Reino de Dios. ¬°Gracias por sembrar en este ministerio y por creer que juntos, como familia, podemos hacer crecer lo que Dios nos ha dado! üíô</b>
  <hr style="border: none; border-top: 1px solid #ff9100; margin:1.2em 0;">
  <b>Hello family! Thank you for supporting our sound ministry. üôåüèΩ</b>
  <br><br>
  Our Buenas Nuevas congregation has already begun and meets weekly. For now, we‚Äôre getting by with our personal practice speakers and basic microphones, which means voices get lost in the music, and our sound is off balance; sometimes it‚Äôs even hard to understand Pastora clearly. It gets us by for now, but let‚Äôs be honest‚Äîwe can‚Äôt stay like this. God doesn‚Äôt just call us to make do; He calls us to *cultivate* and improve what He‚Äôs given us, just like Adam in the garden. God provides the space, but it‚Äôs our job to cultivate it into a church‚Äîthe very thing we‚Äôve been praying for. Every step we take is our way of honoring Him and using well the money and resources He‚Äôs entrusted to us (‚Äúthe master gave each servant talents, each according to their ability‚Äù; we are to multiply with what He has given us ‚Äì Mat. 25:14-30).<br><br>
  <b>As one family in Christ, we move in unity, putting our hearts into everything we do (Col. 3:23). Every gift‚Äîlarge or small‚Äîis a direct investment in the future of Buenas Nuevas and God‚Äôs Kingdom. Thank you for sowing into this ministry and believing that together, as a family, we can grow what God has given us! üíô</b>
</div>

  <!-- INSTRUCTIONS -->

<div class="note" style="margin-top:2.2em 0 2.2em 0; border-top: 4px solid #ff9100;">
<h2 style="color:#ff9100; margin-top:1em;">
¬øC√≥mo Funciona la Lista por Fases? / How the Phase List Works
</h2><br><br>

  Hemos dividido la lista en fases para ayudar a organizar y priorizar las necesidades del ministerio. <b>Fase 1</b> es la prioridad, y los art√≠culos en cada fase est√°n ordenados de mayor a menor importancia. Cuando se completa una fase, avanzamos a la siguiente.<br>
  <br>
  Cada fase tiene un <b>c√≥digo QR</b> que te lleva a la misma lista de regalos. Usa el QR para compartir f√°cilmente esta p√°gina con amigos, familiares o quienes deseen apoyar. <b>Nota:</b> La p√°gina no marca autom√°ticamente los art√≠culos donados; si un art√≠culo ya no aparece en la lista, es probable que ya fue comprado. Comprar por fase es solo una recomendaci√≥n‚Äî¬°puedes escoger cualquier art√≠culo que desees! Si tienes preguntas sobre lo que a√∫n falta, comun√≠cate con nosotros.<br><br>
    <hr style="border: none; border-top: 1px solid #ff9100; margin:1.2em 0;"><br>
  <span style="color:#aaa; font-size:0.95em;">
    We‚Äôve divided the list into phases to help organize and prioritize the ministry‚Äôs needs. <b>Phase 1</b> is the highest priority, and each phase‚Äôs items are listed from most to least important. Once a phase is complete, we move on to the next.<br><br>
    Each phase has a <b>QR code</b> that links to the same registry list. Use the QR to easily share this page with friends, family, or anyone who wants to help. <b>Note:</b> The registry page doesn‚Äôt automatically show received items; if you don‚Äôt see something listed, it‚Äôs probably already been purchased. Buying by phase is just a suggestion‚Äîfeel free to purchase any item you‚Äôd like! If you‚Äôre unsure what‚Äôs still needed, just reach out to us.
  </span>
</div>
<br>
  <!-- ORDERING NOTE + TOP QR -->
  
  <div class="note" style="margin-top:2.2em; border-top: 4px solid #ff9100;">
      <h2 style="color:#ff9100; margin-top:1em;">
  ¬øC√≥mo Hacer Tu Pedido? / How to Order
</h2><br><br>
    <b>Por favor, ordene solamente desde nuestro registro oficial usando los botones naranjas o el c√≥digo QR.
    Si no ve un art√≠culo en el registro, probablemente ya fue comprado.</b><br>
 <hr style="border: none; border-top: 1px solid #ff9100; margin:1.2em 0;">
    <span class="en" style="display:block;margin-top:.6em;color:#fff">Please order only from our official registry using the orange buttons or the QR code.
    If an item isn‚Äôt visible in the registry, it has likely already been purchased.</span>
  </div>
  </div>

  <!-- =========================
       Dynamic Phases (1‚Äì6)
       ========================= -->
  <div id="phases"></div>

  <!-- Modal for enlarged images -->
  <div id="imgModal" class="modal-img-bg">
    <img id="modalImg" src="">
  </div>

  <script>
  const API_URL = "https://script.google.com/macros/s/AKfycbxTvUMgfiDCpxxtgXBpSaR0JxOAWcqUzXL_mvo6Q-k6Oae9GD5zUC3C9-RAZdKgYpV_yw/exec";

  function enlargeImg(img) {
    const m = document.getElementById("imgModal");
    document.getElementById("modalImg").src = img.src;
    m.classList.add("active");
    m.onclick = () => m.classList.remove("active");
  }

  function createBadge(purchased, qty) {
    const div = document.createElement("div");
    if (!qty || isNaN(qty)) qty = 0;
    if (!purchased || isNaN(purchased)) purchased = 0;

    if (purchased >= qty && qty > 0) {
      div.className = "badge green";
      div.textContent = "Completado / Completed";
    } else if (purchased === 0) {
      div.className = "badge";
      div.textContent = `Comprado/Purchased ${purchased}/${qty}`;
    } else {
      div.className = "badge yellow";
      div.textContent = `Comprado/Purchased ${purchased}/${qty}`;
    }
    return div;
  }

  function cardFor(item) {
    const card = document.createElement("div");
    card.className = "item";

    const qty = parseInt(item.quantity) || 0;
    const purchased = parseInt(item.purchased) || 0;

    const badge = createBadge(purchased, qty);
    const img = document.createElement("img");
    img.src = item.image_url || "";
    img.alt = item.title_en || item.title_es || "";
    img.onclick = () => enlargeImg(img);

    const title = document.createElement("div");
    title.className = "item-title";
    title.innerHTML = `${item.title_es || ""}<br><span class='en'>${item.title_en || ""}</span>`;

    const price = document.createElement("div");
    price.className = "price";
    price.textContent = item.price ? `$${item.price}` : "";

    const qtyDiv = document.createElement("div");
    qtyDiv.className = "qty";
    qtyDiv.textContent = qty ? `Cantidad: ${qty}` : "";

    const desc = document.createElement("div");
    desc.className = "desc";
    desc.innerHTML = `${item.desc_es || ""}<br>${item.desc_en || ""}`;

    card.append(badge, img, title, price, qtyDiv, desc);
    return card;
  }

  async function loadMessage() {
    try {
      const res = await fetch(API_URL);
      const data = await res.json();
      const box = document.getElementById("messageCard");
      if (data.message && data.message.trim() !== "") {
        box.textContent = data.message;
        box.classList.add("active");
      } else {
        box.classList.remove("active");
      }
    } catch (err) {
      console.warn("No message box data found.", err);
    }
  }

  async function loadPhases() {
    const phasesContainer = document.getElementById("phases");
    for (let i = 1; i <= 6; i++) {
      const res = await fetch(`${API_URL}?phase=${i}`);
      const data = await res.json();
      const validItems = (data.items || []).filter(it =>
        it && it.image_url && it.image_url.startsWith("http") &&
        !String(it.title_es).includes("Title")
      );

      if (!validItems.length) continue;

      const section = document.createElement("section");
      section.innerHTML = `
        <h2>Fase ${i}<br><span class='en'>Phase ${i}</span></h2>
        <div style="text-align:center; margin-bottom:.8em; font-size:0.7em; color:#ffe53b;">
          Haz clic en cualquier imagen para verla m√°s grande.<br>
          <span style="color:#aac;">Click any picture to enlarge it.</span>
        </div>
        <div id="phase-items-${i}" class="phase-items"></div>
        <div class="registry-actions">
          <div class="qr">
            <img alt="QR ‚Äì Registry" src="https://api.qrserver.com/v1/create-qr-code/?size=260x260&data=https%3A%2F%2Fwww.amazon.com%2Fregistries%2Fgl%2Fguest-view%2F1E6GZIQ5MG9GC">
            <div class="cap">Escanea para ver el registro<br><small>Scan to view the registry</small></div>
          </div>
          <div class="flash-reminder">
            <span>¬°No olvides buscar cupones de descuento antes de comprar!</span><br>
            <span style="font-size:0.98em">Don‚Äôt forget to check for coupons before you order!</span>
          </div>
          <a class="button" href="https://www.amazon.com/registries/gl/guest-view/1E6GZIQ5MG9GC" target="_blank">üõí Ordenar aqu√≠ / Order Here</a>
        </div>
      `;

      phasesContainer.append(section);
      const container = section.querySelector(`#phase-items-${i}`);
      validItems.forEach(it => container.append(cardFor(it)));
    }
  }

  document.addEventListener("DOMContentLoaded", async () => {
    await loadMessage();
    await loadPhases();
  });
  </script>
</body>
</html>
